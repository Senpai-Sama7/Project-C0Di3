[2025-10-06T19:41:20.143Z] [INFO] [AuthService] AuthService initialized
[2025-10-06T19:41:20.452Z] [INFO] [AuthService] AuthService initialized
[
  {
    "id": "auth-admin-login",
    "description": "Admin authenticates with configured password",
    "outcome": {
      "success": true,
      "hasSession": true,
      "tokenLength": 239,
      "userRole": "admin"
    }
  },
  {
    "id": "auth-reject-bad-password",
    "description": "Invalid password is rejected",
    "outcome": {
      "success": false,
      "error": "Invalid credentials"
    }
  },
  {
    "id": "auth-signed-jwt",
    "description": "Valid token decodes, tampered token fails",
    "outcome": {
      "validToken": {
        "valid": true,
        "session": {
          "id": "cd0667e10543e0e05dbdb899966b44e6",
          "userId": "admin",
          "username": "admin",
          "createdAt": "2025-10-06T19:41:20.252Z",
          "lastActivity": "2025-10-06T19:41:20.355Z",
          "permissions": [
            {
              "resource": "*",
              "action": "*"
            }
          ],
          "isActive": true,
          "refreshToken": "8ef2bc85b17bbe03f30c8837a081414abb6e4d72c00d0cce48f55aaae4966638",
          "refreshTokenExpiry": "2025-10-13T19:41:20.252Z"
        },
        "user": {
          "id": "admin",
          "username": "admin",
          "role": "admin",
          "permissions": [
            {
              "resource": "*",
              "action": "*"
            }
          ],
          "createdAt": "2025-10-06T19:41:20.142Z",
          "lastLogin": "2025-10-06T19:41:20.252Z",
          "isActive": true,
          "failedLoginAttempts": 1
        }
      },
      "tamperedResult": {
        "valid": false,
        "error": "Invalid token signature"
      }
    }
  },
  {
    "id": "auth-stored-hash",
    "description": "Stored user record contains hash and salt but no plaintext password",
    "outcome": {
      "id": "admin",
      "username": "admin",
      "role": "admin",
      "permissions": [
        {
          "resource": "*",
          "action": "*"
        }
      ],
      "createdAt": "2025-10-06T19:41:20.142Z",
      "lastLogin": "2025-10-06T19:41:20.252Z",
      "isActive": true,
      "failedLoginAttempts": 1,
      "passwordHash": "eeb488a9fb37b5902b87f38627650649aaa644076bbee2a17017fd4024d59834",
      "passwordSalt": "9aa3cc0471c32d533d29ffe58e46e9a4"
    }
  },
  {
    "id": "auth-context",
    "description": "Temporary directory used for this verification run",
    "outcome": {
      "tmpDir": "/tmp/auth-reality-VDPufy",
      "files": [
        "sessions.json",
        "users.json"
      ]
    }
  },
  {
    "id": "auth-legacy-migration",
    "description": "Legacy user records missing hashes are auto-migrated with warnings",
    "outcome": {
      "migratedLogin": true,
      "storedHash": true,
      "storedSalt": true,
      "retainedPlaintext": false
    }
  }
]
